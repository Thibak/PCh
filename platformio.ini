#
# PlatformIO Project Configuration File
#
# Пожалуйста, ознакомьтесь с документацией:
# https://docs.platformio.org/page/projectconf.html
#
# Этот файл настроен в соответствии с ARCH_CONTRACT.MD (Раздел 5)
#

[platformio]
# Окружение по умолчанию для сборки/тестирования
default_envs = native

# Структура папок, согласно ARCH_CONTRACT.MD
src_dir = src
include_dir = include
lib_dir = lib
test_dir = test
data_dir = data

[env]
# --- Общие настройки для ВСЕХ окружений ---

# Скорость Serial-монитора
monitor_speed = 115200


[env:native]
# -----------------------------------------------------------------
# Окружение: native (Host-First)
# Сборка и тестирование на ПК (Windows/Linux/macOS)
# -----------------------------------------------------------------
platform = native
# (framework здесь не указываем!)

# --- Настройка статического анализа (Спринт 1.1) ---
check_tool = cppcheck
check_flags = 
    cppcheck: --enable=all --suppress=missingIncludeSystem

# Флаги сборки для Unity (тестовый фреймворк PIO)
build_flags =
    -D UNITY_INCLUDE_CONFIG_H
    -D UNITY_EXCLUDE_SETJMP_H
    -D UNITY_EXCLUDE_MATH_H
    -D UNITY_EXCLUDE_FLOAT
    -D NATIVE_TEST # Наш флаг, чтобы код знал, что он в `native`


[env:esp32s3_app]
# -----------------------------------------------------------------
# Окружение: esp32s3_app (Target)
# Сборка и прошивка для целевого устройства
# -----------------------------------------------------------------
platform = espressif32
board = esp32-s3-devkitc-1  # <--- !! ВАЖНО: Замени на свою плату ESP32-S3 !!
# (напр. 'adafruit_feather_esp32_s3' или 'lolin_s3')

framework = arduino         

lib_deps =
    # Библиотека для BLE-MIDI
    lathoub/Arduino-BLE-MIDI @ 5.1.2

build_flags =
    -D ESP32_TARGET # Наш флаг, чтобы код знал, что он на "железе"